<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Day Sülalesi Soyağacı</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: white;
      z-index: 1000;
      padding: 10px 0;
      text-align: center;
      border-bottom: 1px solid #ccc;
    }

    header h1 {
      margin: 0;
      font-size: 22px;
    }

    .explanation {
      padding: 8px 12px;
      font-size: 14px;
      line-height: 1.4;
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }

    .container {
      position: absolute;
      top: 150px; /* Header yüksekliğine göre */
      left: 0;
      right: 0;
      bottom: 0;
      overflow: auto;
      text-align: center;
    }

    #chart_div {
      display: inline-block;
      min-width: 100%;
      min-height: 100%;
      cursor: grab;
    }

    .chart-zoom-wrapper {
      display: inline-block;
      transform-origin: center center;
      transition: transform 0.3s ease;
    }

    /* Zoom butonları */
    .zoom-controls {
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .zoom-controls button {
      width: 40px;
      height: 40px;
      font-size: 22px;
      cursor: pointer;
      background: white;
      border: 1px solid #ccc;
      border-radius: 50%;
    }

    /* Düğmeler üzerine gelince */
    .zoom-controls button:hover {
      background: #eee;
    }
  </style>
</head>
<body>
  <header>
    <h1>👨‍👩‍👧‍👦 Day Sülalesi Soyağacı</h1>
    <div class="explanation">
      Bu soyağacı <strong>Berat Day</strong> tarafından dinamik olarak oluşturulmuştur. Yapılan herhangi bir girişte düzenleme aynı isim ve tarih seçerek oluşturulabilmektedir. 
      Farklı isimle yanlışlıkla oluşturulan yeni olmayan bir aile bireyi için iletişime geçiniz. 
      İletişim için <strong>05434813373</strong>.<br><br>
      Buradan kişiler ekleyebilir ve güncelleyebilirsiniz:
      <a href="javascript:void(0);" onclick="window.open(FORM_LINKI, '_blank');" class="new-entry-link">
        + Yeni Kişi / Güncelleme Formu
      </a>
    </div>
  </header>

  <div class="container" id="container">
    <div id="chart_div">
      <div class="chart-zoom-wrapper" id="chart_wrapper"></div>
    </div>
  </div>

  <div class="zoom-controls">
    <button id="zoom-in">+</button>
    <button id="zoom-out">−</button>
  </div>

  <script>
    const FORM_LINKI = "https://docs.google.com/forms/..."; // kendi form linkini koy

    google.charts.load('current', { packages: ['orgchart'] });
    google.charts.setOnLoadCallback(drawChart);

    let zoomLevel = 1;

    function drawChart() {
      const data = new google.visualization.DataTable();
      data.addColumn('string', 'Name');
      data.addColumn('string', 'Manager');
      data.addColumn('string', 'ToolTip');

      // 🧬 Test datası (burayı kendi verinle değiştir)
      data.addRows([
        [{ v: '1', f: 'Kök Kişi' }, '', ''],
        [{ v: '2', f: 'Çocuk 1' }, '1', ''],
        [{ v: '3', f: 'Çocuk 2' }, '1', ''],
        [{ v: '4', f: 'Torun 1' }, '2', ''],
        [{ v: '5', f: 'Torun 2' }, '2', ''],
        [{ v: '6', f: 'Torun 3' }, '3', '']
      ]);

      const chart = new google.visualization.OrgChart(document.getElementById('chart_wrapper'));
      chart.draw(data, { allowHtml: true });

      centerChart(); // sayfa yüklendiğinde ortala
    }

    // 📐 Ortalamak için
    function centerChart() {
      const container = document.getElementById('container');
      const wrapper = document.getElementById('chart_wrapper');
      container.scrollLeft = (wrapper.offsetWidth - container.clientWidth) / 2;
      container.scrollTop = (wrapper.offsetHeight - container.clientHeight) / 2;
    }

    // 🕹️ Zoom butonları
    document.getElementById('zoom-in').addEventListener('click', () => {
      zoomLevel += 0.1;
      applyZoom();
    });
    document.getElementById('zoom-out').addEventListener('click', () => {
      zoomLevel = Math.max(0.3, zoomLevel - 0.1);
      applyZoom();
    });

    function applyZoom() {
      document.getElementById('chart_wrapper').style.transform = `scale(${zoomLevel})`;
      centerChart();
    }

    // 📱 Mobil pinch zoom desteği
    let lastDistance = null;
    const containerEl = document.getElementById('container');

    containerEl.addEventListener('touchmove', function (e) {
      if (e.touches.length === 2) {
        e.preventDefault();
        const dx = e.touches[0].clientX - e.touches[1].clientX;
        const dy = e.touches[0].clientY - e.touches[1].clientY;
        const distance = Math.sqrt(dx * dx + dy * dy);

        if (lastDistance) {
          const delta = distance - lastDistance;
          zoomLevel += delta * 0.001;
          zoomLevel = Math.min(Math.max(zoomLevel, 0.3), 3);
          applyZoom();
        }
        lastDistance = distance;
      }
    }, { passive: false });

    containerEl.addEventListener('touchend', () => { lastDistance = null; });
  </script>
</body>
</html>
