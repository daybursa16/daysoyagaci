<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
  <title>Day S√ºlalesi Soyaƒüacƒ±</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    header {
      background: #003366;
      color: white;
      padding: 10px;
      text-align: center;
      font-size: 20px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
    }

    .explanation {
      background: #f0f0f0;
      padding: 12px;
      text-align: center;
      font-size: 14px;
      line-height: 1.4;
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      z-index: 999;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .new-entry-link {
      color: #003366;
      font-weight: bold;
      text-decoration: underline;
    }

    #chart_div {
      position: absolute;
      top: 140px; /* header + explanation y√ºksekliƒüi kadar */
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
      touch-action: none;
      background: #fff;
    }

    #tree-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
      transform-origin: center center;
      transition: transform 0.1s ease-out;
      white-space: nowrap;
    }

    .node {
      display: inline-block;
      background: #f0f0f0;
      border: 1px solid #999;
      padding: 5px 10px;
      margin: 10px;
      border-radius: 5px;
      text-align: center;
      max-width: 120px;
      word-wrap: break-word;
      white-space: normal;
      position: relative;
    }

    .toggle-btn {
      position: absolute;
      top: -12px;
      right: -12px;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: #003366;
      color: white;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    #zoom-controls {
      position: fixed;
      bottom: 20px;
      left: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 1000;
    }

    #zoom-controls button {
      width: 40px;
      height: 40px;
      border: none;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      background: #003366;
      color: white;
    }

    @media (max-width: 768px) {
      header {
        font-size: 16px;
      }
      .explanation {
        font-size: 13px;
      }
      .node {
        max-width: 100px;
        font-size: 13px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Day S√ºlalesi Soyaƒüacƒ±</h1>
  </header>

  <div class="explanation">
    Bu soyaƒüacƒ± <strong>Berat Day</strong> tarafƒ±ndan dinamik olarak olu≈üturulmu≈ütur. 
    Yapƒ±lan herhangi bir giri≈üte d√ºzenleme aynƒ± isim ve tarih se√ßerek olu≈üturulabilmektedir. 
    Farklƒ± isimle yanlƒ±≈ülƒ±kla olu≈üturulan yeni olmayan bir aile bireyi i√ßin ileti≈üime ge√ßiniz. 
    ƒ∞leti≈üim i√ßin <strong>05434813373</strong>.
    <br><br>
    Buradan ki≈üiler ekleyebilir ve g√ºncelleyebilirsiniz:
    <a href="javascript:void(0);" onclick="window.open(FORM_LINKI, '_blank');" class="new-entry-link">
      + Yeni Ki≈üi / G√ºncelleme Formu
    </a>
  </div>

  <div id="chart_div">
    <div id="tree-content"></div>
  </div>

  <div id="zoom-controls">
    <button id="zoom-in">+</button>
    <button id="zoom-out">‚àí</button>
  </div>

  <script>
    // üìå Test verisi - senin verinle deƒüi≈ütirilebilir
    const treeData = {
      name: "K√∂k Ebeveyn",
      children: [
        { name: "√áocuk 1 Uzun ƒ∞simli Birey", children: [{ name: "Torun 1" }, { name: "Torun 2" }] },
        { name: "√áocuk 2" },
        { name: "√áocuk 3", children: [{ name: "Torun 3" }] }
      ]
    };

    const container = document.getElementById("chart_div");
    const content = document.getElementById("tree-content");

    function createNode(data) {
      const node = document.createElement("div");
      node.className = "node";
      node.textContent = data.name;

      if (data.children && data.children.length > 0) {
        const toggleBtn = document.createElement("div");
        toggleBtn.className = "toggle-btn";
        toggleBtn.textContent = "-";
        node.appendChild(toggleBtn);

        const childrenContainer = document.createElement("div");
        childrenContainer.style.marginTop = "10px";

        data.children.forEach(child => {
          const childNode = createNode(child);
          childrenContainer.appendChild(childNode);
        });

        node.appendChild(childrenContainer);

        toggleBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          const visible = childrenContainer.style.display !== "none";
          childrenContainer.style.display = visible ? "none" : "block";
          toggleBtn.textContent = visible ? "+" : "-";
        });
      }

      return node;
    }

    content.appendChild(createNode(treeData));

    let scale = 1;
    let originX = window.innerWidth / 2;
    let originY = window.innerHeight / 2;

    function updateTransform() {
      content.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
    }

    document.getElementById("zoom-in").addEventListener("click", () => {
      scale *= 1.2;
      updateTransform();
    });

    document.getElementById("zoom-out").addEventListener("click", () => {
      scale /= 1.2;
      updateTransform();
    });

    // Mouse s√ºr√ºkleme
    let isDragging = false;
    let startX, startY;

    container.addEventListener("mousedown", (e) => {
      isDragging = true;
      startX = e.clientX - originX;
      startY = e.clientY - originY;
    });

    container.addEventListener("mousemove", (e) => {
      if (!isDragging) return;
      originX = e.clientX - startX;
      originY = e.clientY - startY;
      updateTransform();
    });

    container.addEventListener("mouseup", () => (isDragging = false));
    container.addEventListener("mouseleave", () => (isDragging = false));

    // Dokunmatik s√ºr√ºkleme
    let touchStartX = 0, touchStartY = 0;
    container.addEventListener("touchstart", (e) => {
      if (e.touches.length === 1) {
        touchStartX = e.touches[0].clientX - originX;
        touchStartY = e.touches[0].clientY - originY;
      }
    });

    container.addEventListener("touchmove", (e) => {
      if (e.touches.length === 1) {
        originX = e.touches[0].clientX - touchStartX;
        originY = e.touches[0].clientY - touchStartY;
        updateTransform();
      }
    });

    // Pinch Zoom (iki parmak)
    let pinchStart = 0;
    container.addEventListener("touchstart", (e) => {
      if (e.touches.length === 2) {
        pinchStart = Math.hypot(
          e.touches[0].clientX - e.touches[1].clientX,
          e.touches[0].clientY - e.touches[1].clientY
        );
      }
    });

    container.addEventListener("touchmove", (e) => {
      if (e.touches.length === 2) {
        const pinchEnd = Math.hypot(
          e.touches[0].clientX - e.touches[1].clientX,
          e.touches[0].clientY - e.touches[1].clientY
        );
        const zoomFactor = pinchEnd / pinchStart;
        scale *= zoomFactor;
        pinchStart = pinchEnd;
        updateTransform();
      }
    });

    function centerTree() {
      originX = window.innerWidth / 2;
      originY = (window.innerHeight - 140) / 2; // a√ßƒ±klama + header kadar yukarƒ±dan bo≈üluk
      scale = 1;
      updateTransform();
    }

    centerTree();
    window.addEventListener("resize", centerTree);
  </script>
</body>
</html>
